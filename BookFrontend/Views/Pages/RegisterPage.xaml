<Page x:Class="book_frontend.Views.Pages.RegisterPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:views="clr-namespace:book_frontend.Views.UserControls"
      xmlns:viewModels="clr-namespace:book_frontend.ViewModels"
      mc:Ignorable="d"
      d:DataContext="{d:DesignInstance viewModels:RegisterViewModel}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 主要内容区域 -->
        <Border Grid.Row="0" Background="White" CornerRadius="10" Margin="30,20,30,20">
            <Border.Effect>
                <DropShadowEffect Color="Gray" Direction="270" ShadowDepth="3" Opacity="0.3" BlurRadius="10" />
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- 标题 -->
                <TextBlock Grid.Row="0" Text="用户注册"
                           FontSize="28" FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Margin="0,10,0,5"
                           Foreground="#2196F3" />

                <!-- 注册表单 -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="40,0,40,0">
                    <StackPanel VerticalAlignment="Top">

                        <!-- 姓名输入框 -->
                        <materialDesign:PackIcon Kind="Account"
                                                 Foreground="#2196F3"
                                                 Width="24" Height="24"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,0,0,5" />
                        <TextBox x:Name="NameTextBox"
                                 materialDesign:HintAssist.Hint="请输入姓名"
                                 materialDesign:HintAssist.IsFloating="True"
                                 Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                 Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0,0,0,20"
                                 FontSize="16" />

                        <!-- 邮箱输入框 -->
                        <materialDesign:PackIcon Kind="Email"
                                                 Foreground="#2196F3"
                                                 Width="24" Height="24"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,0,0,5" />
                        <TextBox x:Name="EmailTextBox"
                                 materialDesign:HintAssist.Hint="请输入邮箱地址"
                                 materialDesign:HintAssist.IsFloating="True"
                                 Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                 Text="{Binding Email, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0,0,0,20"
                                 FontSize="16" />

                        <!-- 密码输入框 -->
                        <materialDesign:PackIcon Kind="Lock"
                                                 Foreground="#2196F3"
                                                 Width="24" Height="24"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,0,0,5" />
                        <PasswordBox x:Name="PasswordBox"
                                     materialDesign:HintAssist.Hint="请输入密码"
                                     materialDesign:HintAssist.IsFloating="True"
                                     Style="{StaticResource MaterialDesignFloatingHintPasswordBox}"
                                     materialDesign:PasswordBoxAssist.Password="{Binding Password, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,20"
                                     FontSize="16" />

                        <!-- 确认密码输入框 -->
                        <materialDesign:PackIcon Kind="LockCheck"
                                                 Foreground="#2196F3"
                                                 Width="24" Height="24"
                                                 HorizontalAlignment="Left"
                                                 Margin="0,0,0,5" />
                        <PasswordBox x:Name="ConfirmPasswordBox"
                                     materialDesign:HintAssist.Hint="请确认密码"
                                     materialDesign:HintAssist.IsFloating="True"
                                     Style="{StaticResource MaterialDesignFloatingHintPasswordBox}"
                                     materialDesign:PasswordBoxAssist.Password="{Binding ConfirmPassword, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,0,0,30"
                                     FontSize="16" />

                        <!-- 错误消息 -->
                        <TextBlock Text="{Binding ErrorMessage}"
                                   Foreground="Red"
                                   FontSize="14"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,10"
                                   Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}" />

                        <!-- 成功消息 -->
                        <TextBlock Text="{Binding SuccessMessage}"
                                   Foreground="Green"
                                   FontSize="14"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,10"
                                   Visibility="{Binding SuccessMessage, Converter={StaticResource StringToVisibilityConverter}}" />

                        <!-- 注册按钮 -->
                        <Button Content="注册"
                                Command="{Binding RegisterCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Background="#2196F3"
                                Foreground="White"
                                FontSize="16"
                                Height="45"
                                Margin="0,10,0,0"
                                IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBooleanConverter}}" />

                    </StackPanel>
                </ScrollViewer>

                <!-- 底部信息 -->
                <StackPanel Grid.Row="2" Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Margin="0,20,0,30">
                    <TextBlock Text="已有账户？"
                               FontSize="14"
                               Foreground="Gray"
                               VerticalAlignment="Center" />
                    <Button Content="立即登录"
                            Style="{StaticResource MaterialDesignFlatButton}"
                            Foreground="#2196F3"
                            FontSize="14"
                            Margin="5,0,0,0"
                            Click="LoginButton_Click" />
                </StackPanel>

            </Grid>
        </Border>

        <!-- 加载遮罩（改为可复用控件） -->
        <views:LoadingMask IsBusy="{Binding IsLoading}" LoadingText="注册中..." />
    </Grid>
</Page>